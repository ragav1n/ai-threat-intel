Loading custom dataset from: data/evaluation/new_real_world_dataset.json
Dataset: 134 samples, 549 expected IOCs
Categories: {"true_positive": 134}

====================================================================
  1. CORE EVALUATION METRICS
====================================================================
  Precision (Micro):  0.9916 (99.2%)
  Recall (Micro):     0.8597 (86.0%)
  F1 Score (Micro):   0.9210 (92.1%)

  Macro Precision:    0.9920 (99.2%)
  Macro Recall:       0.8964 (89.6%)
  Macro F1:           0.9349 (93.5%)
  Weighted F1:        0.9112 (91.1%)

  MCC:                0.6031
  Cohen's Kappa:      0.5516

  TP: 472  FP: 4  FN: 77  TN: 66

  Confidence Calibration:
    Avg TP Confidence: 0.8153
    Avg FP Confidence: 0.4875

  Category Accuracy:
    true_positive        81.3%

  Per-Type Breakdown:
    Type       TP   FP   FN    Prec  Recall      F1
    cve       224    0    1 100.0%  99.6%  99.8%
    domain     92    3   60  96.8%  60.5%  74.5%
    email       5    0    0 100.0% 100.0% 100.0%
    ip         60    1    0  98.4% 100.0%  99.2%
    sha256     35    0    0 100.0% 100.0% 100.0%
    url        56    0   16 100.0%  77.8%  87.5%


================================================================================
  BASELINE COMPARISON
================================================================================
  Extractor                         Prec  Recall      F1    TP   FP   FN
  ------------------------------ ------- ------- -------  ---- ---- ----
  Our Pipeline                    99.2%  86.0%  92.1%   472    4   77
  iocextract (InQuest)             0.0%   0.0%   0.0%     0    0  549
  ioc-finder (Hightower)           0.0%   0.0%   0.0%     0    0  549
  Regex Only (no filter)          76.5%  63.0%  69.1%   346  106  203

  Per-Type F1 Comparison:
  Type          Our Pipeline iocextract (InQ ioc-finder (Hig Regex Only (no 
  ---------- --------------- --------------- --------------- ---------------
  cve                 99.8%           0.0%           0.0%          99.8%
  domain              74.5%           0.0%           0.0%          34.3%
  email              100.0%           0.0%           0.0%          75.0%
  ip                  99.2%           0.0%           0.0%           6.5%
  ipv6                 0.0%           0.0%           0.0%           0.0%
  sha256             100.0%           0.0%           0.0%         100.0%
  url                 87.5%           0.0%           0.0%          58.8%
================================================================================

================================================================================
  ABLATION STUDY
================================================================================
  Config                                        Prec  Recall      F1    TP   FP   FN
  ------------------------------------------ ------- ------- -------  ---- ---- ----
  A. Regex Only                               76.5%  63.0%  69.1%   346  106  203
  B. Regex + Deobfuscation                    85.5%  99.6%  92.0%   547   93    2
  C. Regex + Deobfusc. + Domain Filter        97.3%  98.0%  97.6%   538   15   11
  D. Full Pipeline                            97.8%  88.7%  93.0%   487   11   62

  Component Contribution (delta from Regex Only):
  Component                                       dP      dR     dF1    dFP   dFN
  ------------------------------------------ ------- ------- -------  ----- -----
  B. Regex + Deobfuscation                    +8.9% +36.6% +22.9%    -13  -201
  C. Regex + Deobfusc. + Domain Filter       +20.7% +35.0% +28.5%    -91  -192
  D. Full Pipeline                           +21.2% +25.7% +23.9%    -95  -141
================================================================================

====================================================================
  BOOTSTRAP CONFIDENCE INTERVALS (1000 iterations, 95% CI)
====================================================================
  Metric          Point   95% CI Lower  95% CI Upper     Width
  ------------ --------   ------------  ------------  --------
  Precision      99.2%         97.9%        100.0%      2.1%
  Recall         86.0%         78.6%         92.3%     13.7%
  F1 Score       92.1%         87.9%         95.5%      7.6%
====================================================================

========================================================================
  ERROR ANALYSIS
========================================================================
  Total False Positives: 4
  Total False Negatives: 77

  FP Failure Categories:
    over_matching_domain             3  ( 75.0%)
    version_string_ip                1  ( 25.0%)

  FN Failure Categories:
    domain_filtered                 36  ( 46.8%)
    deobfuscation_failure           26  ( 33.8%)
    url_regex_miss                  14  ( 18.2%)
    unknown                          1  (  1.3%)

  Detailed Errors:
    [FN] report_011      domain   blue.drx                                 → domain_filtered
    [FN] report_011      domain   39uchxifap4cvgzsuirom0szrrg.d65lre9sfqnl → deobfuscation_failure
    [FN] report_011      url      https://github.com/nicocha30/ligolo-ng/r → deobfuscation_failure
    [FN] report_011      domain   transfer.weepee.io                       → deobfuscation_failure
    [FN] report_011      domain   judiemkqjajsfzpidfjlowgl8nyrtd49x.oast.f → deobfuscation_failure
    [FP] report_012      domain   eyes.sh                                  → over_matching_domain
    [FP] report_012      domain   introo.sh                                → over_matching_domain
    [FP] report_012      domain   agent.sh                                 → over_matching_domain
    [FN] report_012      url      https://e598292a5fbd.ngrok-free.app/     → deobfuscation_failure
    [FN] report_013      domain   csdh.wangzhan.mobi                       → deobfuscation_failure
    [FN] report_013      domain   cdnimg.jeayacrai.in.net                  → deobfuscation_failure
    [FN] report_013      domain   www.ludashi.com                          → deobfuscation_failure
    [FN] report_013      domain   www.dropbox.com                          → deobfuscation_failure
    [FN] report_013      domain   90999.fdjk34sddsf90999.cc                → deobfuscation_failure
    [FN] report_013      domain   kccomputech.in                           → deobfuscation_failure
    [FN] report_013      domain   link.members-ms.jp                       → deobfuscation_failure
    [FN] report_013      domain   wa.me                                    → deobfuscation_failure
    [FN] report_013      domain   gld45a.cqxqlsz.com                       → deobfuscation_failure
    [FN] report_013      domain   presentation.pptx                        → domain_filtered
    [FN] report_013      domain   k12sns.apk                               → domain_filtered
    [FN] report_013      domain   resourcepro.tycheint.com                 → deobfuscation_failure
    [FN] report_013      domain   www.sgnl-web.org-status.nl               → deobfuscation_failure
    [FN] report_013      domain   nagapocker.apk                           → domain_filtered
    [FN] report_013      domain   signal-qr.org                            → deobfuscation_failure
    [FN] report_013      domain   pyreneesakbash.com                       → deobfuscation_failure
    [FN] report_013      domain   azojwdsj.xinchaoshan.com                 → deobfuscation_failure
    [FN] report_013      domain   app-u7cp-release.apk                     → domain_filtered
    [FN] report_013      domain   2fliff.line.me                           → domain_filtered
    [FN] report_013      domain   fable.tele-tale.cn                       → deobfuscation_failure
    [FN] report_013      domain   t.k12.com.cn                             → deobfuscation_failure
    [FN] report_013      domain   gricanjolt.com                           → deobfuscation_failure
    [FN] report_013      domain   xlq.wpybta.icu                           → deobfuscation_failure
    [FN] report_013      domain   qrco.de                                  → deobfuscation_failure
    [FN] report_013      domain   yicai.apk                                → domain_filtered
    [FN] report_013      domain   kzeva2010.sbs                            → deobfuscation_failure
    [FN] report_013      domain   xincai.apk                               → deobfuscation_failure
    [FP] report_016      ip       1.1.1.1                                  → version_string_ip
    [FN] report_016      domain   win.ini                                  → domain_filtered
    [FN] report_018      domain   icosetup64.ini                           → domain_filtered
    [FN] report_018      domain   cng.sys                                  → domain_filtered
    [FN] report_021      url      https://www.crowdstrike.com/en-us/platfo → url_regex_miss
    [FN] report_021      domain   www.crowdstrike.com                      → domain_filtered
    [FN] report_022      domain   www.elliptic.co                          → domain_filtered
    [FN] report_022      domain   www.ic3.gov                              → domain_filtered
    [FN] report_039      cve      cve-2025-8088                            → unknown
    [FN] report_049      domain   chargemap.com                            → domain_filtered
    [FN] report_050      domain   contact.yokogawa.com                     → domain_filtered
    [FN] report_050      domain   web-material3.yokogawa.com               → domain_filtered
    [FN] report_053      domain   ev.energy                                → domain_filtered
    [FN] report_053      domain   www.ev.energy                            → domain_filtered
    [FN] report_054      domain   www.mobility46.se                        → domain_filtered
    [FN] report_054      domain   mobility46.se                            → domain_filtered
    [FN] report_055      domain   cloudcharge.tech                         → domain_filtered
    [FN] report_056      domain   ev2go.io                                 → domain_filtered
    [FN] report_057      domain   swtchenergy.com                          → domain_filtered
    [FN] report_058      domain   frickcontrolsblob.file.core.windows.net  → domain_filtered
    [FN] report_062      domain   www.se.com                               → domain_filtered
    [FN] report_066      url      https://www.cisa.gov/notification        → url_regex_miss
    [FN] report_066      url      https://www.cisa.gov/privacy-policy      → url_regex_miss
    [FN] report_066      domain   www.cisa.gov                             → domain_filtered
    [FN] report_067      domain   enoceanwiki.atlassian.net                → domain_filtered
    [FN] report_069      url      https://www.cisa.gov/privacy-policy      → url_regex_miss
    [FN] report_069      domain   www.cisa.gov                             → domain_filtered
    [FN] report_069      url      https://www.cisa.gov/notification        → url_regex_miss
    [FN] report_069      domain   www.valmet.com                           → domain_filtered
    [FN] report_072      domain   support.sw.siemens.com                   → domain_filtered
    [FN] report_072      url      https://support.sw.siemens.com/product/2 → url_regex_miss
    [FN] report_072      url      https://support.sw.siemens.com/product/2 → url_regex_miss
    [FN] report_073      url      https://www.gevernova.com/grid-solutions → url_regex_miss
    [FN] report_073      domain   www.gevernova.com                        → domain_filtered
    [FN] report_074      domain   downloadcenter.deltaww.com               → domain_filtered
    [FN] report_074      url      https://www.deltaww.com/en-us/service-su → url_regex_miss
    [FN] report_074      domain   www.deltaww.com                          → domain_filtered
    [FN] report_074      url      https://downloadcenter.deltaww.com/en-us → url_regex_miss
    [FN] report_075      domain   www.honeywell.com                        → domain_filtered
    [FN] report_075      domain   www.cisa.gov                             → domain_filtered
    [FN] report_075      url      https://www.honeywell.com/us/en/contact/ → url_regex_miss
    [FN] report_075      url      https://www.cisa.gov/privacy-policy      → url_regex_miss
    [FN] report_075      url      https://www.cisa.gov/notification        → url_regex_miss
    [FN] report_078      domain   www.siemens.com                          → domain_filtered
    [FN] report_078      url      https://www.siemens.com/cert/operational → url_regex_miss
========================================================================

====================================================================
  6. LATENCY BENCHMARKS
====================================================================
  Total Time:  73.0ms
  Throughput:  1836 samples/sec
  deobfuscation         mean=0.103ms  p95=0.584ms  p99=1.030ms
  regex_extraction      mean=0.441ms  p95=2.657ms  p99=4.452ms
  end_to_end            mean=0.545ms  p95=3.241ms  p99=5.531ms
====================================================================
